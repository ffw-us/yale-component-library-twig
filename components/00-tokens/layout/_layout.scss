@use '~@yalesites-org/tokens/build/scss/tokens';
@use '../../00-tokens/functions/map';

:root {
  --size-spacing-site-gutter: var(--size-spacing-5);

  /* The `--spacing-page-section` variable is the larger spacing that is
   * used between "section" components. Components that are "standalone" content
   * like a card grid, or a callout should use this. */
  --spacing-page-section: var(--size-spacing-8);

  /* The `--spacing-page-inner` variable is the smaller spacing that is used
   * between "content-like" components. It is used between components within a
   * logical section. */
  --spacing-page-inner: var(--size-spacing-7);

  @media (min-width: tokens.$break-m) {
    --size-spacing-site-gutter: var(--size-spacing-6);
  }

  @media (min-width: tokens.$break-l) {
    --size-spacing-site-gutter: var(--size-spacing-7);
    --spacing-page-section: var(--size-spacing-10);
  }

  @media (min-width: tokens.$break-xl) {
    --size-spacing-site-gutter: var(--size-spacing-8);
  }

  @media (min-width: tokens.$break-2xl) {
    --size-spacing-site-gutter: var(--size-spacing-10);
  }
}

// "Freeze" the body when a modal is open to prevent background scrolling.
body[data-modal-active='true'] {
  overflow: hidden;
}

$layout-widths: map.deep-get(tokens.$tokens, size, component-layout, width);

[data-component-width] {
  &:not([data-embedded-components] [data-component-width]) {
    padding-inline: var(--size-spacing-site-gutter);
  }
}

[class*='__inner'] {
  width: var(--component-width);
  max-width: 100%;
  margin-inline: auto;

  @each $width, $value in $layout-widths {
    [data-component-width='#{$width}'] & {
      --component-width: var(--size-component-layout-width-#{$width});
    }
  }
}

// The spacing-page-inner mixin should be applied to components that are
// "content-like." They generally accompany other components within a "section."
@mixin spacing-page-inner {
  &:not(.no-page-spacing) {
    margin-bottom: var(--spacing-page-inner);
  }
}

// The spacing-page-section mixin should be applied to components that are
// intended to "stand out" from the components around them. A callout, or a card
// grid, for example, may relate to the text around them, but they're not "part"
// of the text.
@mixin spacing-page-section($flush-bottom: false, $flush-top: false) {
  margin-block: var(--spacing-page-section);

  @if $flush-top == true {
    &:first-child {
      --main-content-top-margin: 0;
    }
  }

  @if $flush-bottom == true {
    &:last-child {
      --main-content-bottom-margin: 0;
    }
  }
}

// The first item inside the `.main-content` area should have some space between
// it and the site header (size-spacing-7 and 9 below) - unless it is designated
// as `$flush-top` above. Then it will have no top-margin separating it from the
// site header.
.main-content > *:first-child {
  --main-content-top-margin-default: var(--size-spacing-7);

  margin-top: var(
    --main-content-top-margin,
    var(--main-content-top-margin-default)
  );

  @media (min-width: tokens.$break-mobile) {
    --main-content-top-margin-default: var(--size-spacing-9);
  }
}

// The last item inside the `.main-content` area should have some space between
// it and the site footer (size-spacing-12 below) - unless it is designated as
// `$flush-bottom` above. Then it will have no bottom-margin separating it from
// the site footer.
.main-content > *:last-child {
  margin-bottom: var(--main-content-bottom-margin, var(--size-spacing-12));
}
